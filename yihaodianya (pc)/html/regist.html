<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>1号店(yhd.com)_全球超市，轻松到家！</title>
  <link rel="stylesheet" href="http://at.alicdn.com/t/font_1550154_p9yy1y14rbo.css">
  <link rel="stylesheet" href="../css/nav.css">
</head>

<body>
  <!-------------------------------- 头部 ------------------------------------->
  <header></header>

  <!----------------------------------- 注册 -------------------------------->
  <div class="y_regist_wrap ">
    <div class="r_icon1 wc1">

      <div class="y_regist_model">
        <p class="y_regist_tit">1号店注册</p>
        <div class="y_regist_form cl">
          <ul class="cl">
            <li class="ifocus ipt_wrong">

              <div class="y_same_item">
                <input class="ysame_input" type="text" value="" id="userName">
                <span class="y_same_label">用户名</span>
              </div>

              <div class="y_regist_tips y_regist_tips_black" style="top:8px;">
                <div class="y_regtip_rel sl2">
                  用户名不能为空
                </div>
              </div>

              <i class="iconfont icon-duihao"></i>
              <!--提示信息end -->
            </li>

            <li>

              <div class="y_same_item">
                <input class="ysame_input" type="text" _input="" value="" id="phone">
                <span class="y_same_label">手机号</span>
              </div>

              <div class="y_regist_tips y_regist_tips_black" style="top:10px;">
                <div class="y_tips_words y_phone sl2">
                  请填写正确的手机号码，以便 接收订单通知，找回密码等
                </div>
              </div>

              <i class="iconfont icon-duihao"></i>

            </li>


            <li class="validPhoneCodeDiv cl">
              <div class=" y_same_item hahaha">
                <input class="ysame_input" type="text" value="" id="validPhoneCode">
                <span class="y_same_label">短信验证码</span>
              </div>

              <span class="receive_code ">获取验证码</span>

              <div class="y_regist_tips y_regist_tips_red" style="top: 10px;">
                <div class="y_tips_words y_code sl2">
                  如无法接受验证码，请重启手机并确认短信未被拦截！4G用户请关闭4G网络进行接收
                </div>
              </div>

              <i class="iconfont icon-duihao"></i>
            </li>



            <li>
              <div class="y_same_item">
                <input class="ysame_input y_set_password" type="password" id="password">
                <span class="y_same_label">设置密码</span>
              </div>

              <div class="y_regist_tips y_regist_tips_red" style="top: 11px;">
                <div class="y_tips_words y_pwd">
                  6-20个大小
                </div>
              </div>

              <i class="iconfont icon-duihao"></i>
            </li>


            <li>
              <div class="y_same_item">
                <input class="ysame_input" type="password" id="password2">
                <span class="y_same_label">确认密码</span>
              </div>

              <div class="y_regist_tips y_regist_tips_red" style="top:12px;">
                <div class="y_tips_words y_pwd2">
                  请再次输入密码
                </div>
              </div>

              <i class="iconfont icon-duihao"></i>
            </li>

            <li>
              <div class="y_agreement_word">点击注册，表示您同意1号店
                <a href="">《服务协议及隐私声明》</a>
              </div>
              <a class="y_agreement_btn" href="#" id="register_button">同意协议并注册</a>
            </li>

          </ul>

        </div>
      </div>
    </div>
  </div>


  <div class="simplefooter w">
    <a>沪ICP备16050468号</a>|<a>沪B2-20170039</a>|<a>营业执照</a>
    <p>Copyright © 1号店网上超市 2007-2018，All Rights Reserved</p>
  </div>


</body>
<script src="../js/jquery-1.10.1.min.js"></script>
<!-- <script src="../js/nav.js"></script> -->
<script>

  $("header").load("header2.html", function () {
    $.getScript("../js/nav.js");
  });


  $.extend({
    createCode() {
      var str = "0123456789qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM";
      var res = '';
      for (var i = 0; i < 4; i++) {
        var index = Math.round(Math.random() * (str.length - 1));
        var char = str.charAt(index);
        res += char;
      }
      return res;
    }
  });

  $.fn.extend({
    createCode: function () {
      this.html($.createCode)
    }
  });

  $(".receive_code").click(function () {
    $(".receive_code").createCode();
  });


  $("#userName").on("focus", function () {
    $("#userName").next(".y_same_label").css("left", "-80px")
  })
  $("#phone").on("focus", function () {
    $("#phone").next(".y_same_label").css("left", "-80px")
  })
  $("#validPhoneCode").on("focus", function () {
    $("#validPhoneCode").next(".y_same_label").css("left", "-80px")
  })
  $("#password").on("focus", function () {
    $("#password").next(".y_same_label").css("left", "-80px")
  })
  $("#password2").on("focus", function () {
    $("#password2").next(".y_same_label").css("left", "-80px")
  })

  var Juser;
  var Jtel;
  var Jcode;
  var Jpwd;
  var Jpwd2;
  $("#userName").on("focus blur input", function () {
    var user = $("#userName").val();
    var flag = true;
    if (user) {
      var lenReg = /^.{6,12}$/;
      var startReg = /^[^0-9]/;
      var userReg = /^[a-zA-Z_$\u4e00-\u9fa5][0-9a-zA-Z_$\u4e00-\u9fa5]{5,11}$/;
      if (startReg.test(user) == true) {
        if (lenReg.test(user) == true) {
          if (userReg.test(user) == true) {
            $(".y_regtip_rel").parent().next(".icon-duihao").css("display", "block");
            $(".y_regtip_rel").parent().css("display", "none");
            flag = true;
          } else {
            $(".y_regtip_rel").html("用户名含有非法字符!");
            $(".y_regtip_rel").parent().next(".icon-duihao").css("display", "none");
            $(".y_regtip_rel").parent().css("display", "block");
            flag = false;
          }
        } else {
          $(".y_regtip_rel").html("用户名长度需要在6-12位之间!");
          $(".y_regtip_rel").parent().next(".icon-duihao").css("display", "none");
          $(".y_regtip_rel").parent().css("display", "block");
          flag = false;
        }
      } else {
        $(".y_regtip_rel").html("用户名不能以数字开头!");
        $(".y_regtip_rel").parent().next(".icon-duihao").css("display", "none");
        $(".y_regtip_rel").parent().css("display", "block");
        flag = false;
      }
    } else {
      $(".y_regtip_rel").html("用户名不能为空!");
      $(".y_regtip_rel").parent().next(".icon-duihao").css("display", "none");
      $(".y_regtip_rel").parent().css("display", "block");
      flag = false;
    }
    Juser = flag;
    return flag;
  })



  $("#phone").on("blur focus input", function () {
    var phone = $("#phone").val();
    var flag = true;
    if (phone) {
      var phoneReg = /^1[3456789]\d{9}$/;
      if (phoneReg.test(phone) == true) {
        $(".y_phone").parent().next(".icon-duihao").css("display", "block");
        $(".y_phone").parent().css("display", "none");
        flag = true;
      } else {
        $(".y_phone").html("请输入正确的手机号!");
        $(".y_phone").parent().next(".icon-duihao").css("display", "none");
        $(".y_phone").parent().css("display", "block");
        flag = false;
      }
    } else {
      $(".y_phone").html("手机号不能为空!!");
      $(".y_phone").parent().next(".icon-duihao").css("display", "none");
      $(".y_phone").parent().css("display", "block");
      flag = false;
    }
    Jtel = flag;
    return flag;
  })



  $("#validPhoneCode").on("blur focus input", function () {
    var judgeCode = $(".receive_code").html();
    var codeReg = new RegExp(judgeCode, "ig");
    var code = $("#validPhoneCode").val();
    var flag = true;
    if (code) {
      if (codeReg.test(code) == true) {
        $(".y_code").parent().next(".icon-duihao").css("display", "block");
        $(".y_code").parent().css("display", "none");
        flag = true;
      } else {
        $(".y_code").html("验证码错误!!");
        $(".y_code").parent().next(".icon-duihao").css("display", "none");
        $(".y_code").parent().css("display", "block");
        flag = false;
      }
    } else {
      $(".y_code").html("验证码不能为空!!");
      $(".y_code").parent().next(".icon-duihao").css("display", "none");
      $(".y_code").parent().css("display", "block");
      flag = false;
    }
    Jcode = flag;
    return flag;
  })

  $("#password").on("blur focus input", function () {
    var pwd = $("#password").val();
    var flag = true;
    if (pwd) {
      var lenReg = /^.{6,20}$/;
      var pwdReg = /^[\w$]{6,20}$/;
      if (lenReg.test(pwd) == true) {
        if (pwdReg.test(pwd) == true) {
          $(".y_pwd").parent().next(".icon-duihao").css("display", "block");
          $(".y_pwd").parent().css("display", "none");
          flag =true;
        } else {
          $(".y_pwd").html("密码中含有非法字符!!");
          $(".y_pwd").parent().next(".icon-duihao").css("display", "none");
          $(".y_pwd").parent().css("display", "block");
          flag = false;
        }
      } else {
        $(".y_pwd").html("密码长度需要在6-12位之间!!");
        $(".y_pwd").parent().next(".icon-duihao").css("display", "none");
        $(".y_pwd").parent().css("display", "block");
        flag = false;
      }
    } else {
      $(".y_pwd").html("请填写密码!!");
      $(".y_pwd").parent().next(".icon-duihao").css("display", "none");
      $(".y_pwd").parent().css("display", "block");
      flag = false;
    }
    Jpwd = flag;
    return flag;

  })



  $("#password2").on("blur focus input", function () {
    var pwd = $("#password").val();
    var pwd2 = $("#password2").val();
    var flag = true;
    if (pwd2) {
      if (pwd == pwd2) {
        $(".y_pwd2").parent().next(".icon-duihao").css("display", "block");
        $(".y_pwd2").parent().css("display", "none");
        flag = true;
      } else {
        $(".y_pwd2").html("请两次密码不匹配!!");
        $(".y_pwd2").parent().next(".icon-duihao").css("display", "none");
        $(".y_pwd2").parent().css("display", "block");
        flag = false;
      }
    } else {
      $(".y_pwd2").html("请确认密码!!");
      $(".y_pwd2").parent().next(".icon-duihao").css("display", "none");
      $(".y_pwd2").parent().css("display", "block");
      flag = false;
    }
    Jpwd2 = flag;
    return flag;
  })

  $("#register_button").click(function () {
    if (Juser && Jtel && Jcode && Jpwd && Jpwd2) {
      var user = $("#userName").val();
      var tel = $("#phone").val();
      var pwd = $("#password").val();
      // console.log(pwd)
      $.ajax({
        type: "get",
        dataType: "json",
        data:{
          user,
          tel,
          pwd
        },
        url: "../php/regist.php",
        success(res) {
          if (res.status) {
            alert("注册成功");
            location.href="login.html";
          } else {
            alert(res.msg);
          }
        }
      })
    }
  })


</script>

</html>


