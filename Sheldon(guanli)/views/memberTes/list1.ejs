<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <link href="/stylesheets/bootstrap-datepicker.min.css" rel="stylesheet">


  <link href="/gentelella/vendors/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/gentelella/vendors/font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link href="/gentelella/vendors/nprogress/nprogress.css" rel="stylesheet">
  <link href="/gentelella/vendors/iCheck/skins/flat/green.css" rel="stylesheet">
  <link href="/gentelella/vendors/bootstrap-progressbar/css/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet">
  <link href="/gentelella/vendors/jqvmap/dist/jqvmap.min.css" rel="stylesheet">
  <link href="/gentelella/vendors/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
  <link href="/gentelella/build/css/custom.min.css" rel="stylesheet">


  <link href="https://cdn.bootcss.com/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.css" rel="stylesheet">



  <style>
    .main_container {
      min-height: 400px;
      position: relative;
    }

    .col-md-3 {
      width: 240px;
      position: absolute;
      left: 0;
      top: 0;
    }

    .top_nav {
      width: 81%;
      min-height: 400px;
      margin-left: 0px;
      position: absolute;
      left: 0px;
      top: 0;
    }

    .nav_menu {
      width: 100%;
    }

    .scroll-view {
      width: 100%;
      padding: 0px;
    }

    .col-md-12 {
      position: absolute;
      top: 120px;
    }

    .nav_menu {
      height: 50px;
      line-height: 58px;
    }

    .navbar-nav {
      font-size: 20px;
      font-weight: 900;
      line-height: 50px;
    }

    .panel_toolbox {
      min-width: 40px;
    }

    .teshu {
      text-align: center;
      line-height: 30px;
      font-size: 18px;
      color: tomato;
    }

    .hahaah {
      width: 100%;
      height: 100%;
      background: rgba(241, 235, 235, 0.9);
      position: fixed;
      left: 0;
      top: 0;
      display: none;
    }

    .hahaah .yyyy {
      width: 50%;
      height: 65%;
      margin: 40px auto;
    }

    .hahaah .yyyy .row {
      width: 100%;
      height: 100%;
    }

    .col-md-3 {
      position: relative
    }

    .offset-md-3 {
      float: right;
    }

    .aaaa {
      font-size: 10px;
      color: red;
    }
  </style>

</head>

<body>
  <div class="main_container">
    <div class="col-md-3 left_col">
      <div class="left_col scroll-view">
        <div class="navbar nav_title" style="border: 0;">
          <a href="" class="site_title"><i class="fa fa-paw"></i> <span>&nbsp&nbspThe Project</span></a>
        </div>
        <div class="clearfix"></div>

        <div class="profile clearfix">
          <div class="profile_pic">
            <img src="/gentelella/production/images/img.jpg" alt="..." class="img-circle profile_img">
          </div>
          <div class="profile_info">
            <span>Welcome,</span>
            <h2><%=dd.username%></h2>
          </div>
        </div>
        <br>
        <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
          <div class="menu_section active">
            <h3>General</h3>
            <ul class="nav side-menu">
              <li><a href="/memberTes"><i class="fa fa-desktop"></i>开发者列表<span
                    class="fa fa-chevron-down"></span></a></li>
              <li><a href="/memberTes/hadPost"><i class="fa fa-edit"></i>项目列表<span
                    class="fa fa-chevron-down"></span></a></li>
              <li><a href="/users"><i class="fa fa-laptop"></i>退出登录</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>


    <div class="modelllls top_nav">
      <div class="nav_menu">
        <div class="toggle">
          <a id="menu_toggle"><i class="fa fa-bars"></i></a>
        </div>
        <nav class="nav navbar-nav">
          Bug管理系统
        </nav>
      </div>
      <div class="col-md-12 col-sm-12" style="padding:0px">
        <div class="x_panel">
          <div class="x_title">
            <h2 style="margin-top: 15px">开发人员<small>Our Team</small></h2>
            <ul class="nav navbar-right panel_toolbox">
              <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
              </li>
              <li><a class="close-link"><i class="fa fa-close"></i></a>
              </li>
            </ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <p> Welcome to <code>the bug management system</code> , check out your teamt</p>
            <div class="table-responsive">
              <table class="table table-striped jambo_table bulk_action">
                <thead>
                  <tr class="headings">
                    <th>
                      <div class="icheckbox_flat-green" style="position: relative;"><input type="checkbox"
                          id="check-all" class="flat" style="position: absolute; opacity: 0;"><ins class="iCheck-helper"
                          style="position: absolute; top: 0%; left: 0%; display: block; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins>
                      </div>
                    </th>
                    <th class="column-title">开发者</th>
                    <th class="column-title">项目名称</th>
                    <th class="column-title">项目内容</th>
                    <th class="column-title">项目提交时间</th>
                    <th class="column-title">项目bug</th>
                    <th class="column-title">项目状态</th>
                    </th>
                    <th class="bulk-actions" colspan="7">
                      <a class="antoo" style="color:#fff; font-weight:500;">Bulk Actions ( <span class="action-cnt">
                        </span> ) <i class="fa fa-chevron-down"></i></a>
                    </th>
                  </tr>
                </thead>
                <% if(dd.code==0){ %>
                <tbody>
                  <p class="teshu"><%=dd.list %></p>
                </tbody>
                <%}else{ %>

                <%dd.list.forEach(function(item){ %>
                <tbody>
                  <tr class="even pointer">
                    <td class="a-center ">
                      <div class="icheckbox_flat-green" style="position: relative;"><input type="checkbox" class="flat"
                          name="table_records" style="position: absolute; opacity: 0;"><ins class="iCheck-helper"
                          style="position: absolute; top: 0%; left: 0%; display: block; width: 100%; height: 100%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins>
                      </div>
                    </td>
                    <td class=" "><%= item.username %></td>
                    <td class=" "><%= item.projectTitle %></td>
                    <td class=" "><%= item.projectContent%></td>
                    <td class=""><%= moment(item.start).format("YYYY-MM-DD") %></td>
                    <td class=" ">
                      <button type="button" class="btn btn-info btn-xs " id="gunqiu"
                        data_id="<%= item['_id'] %>">提交bug</button>
                    </td>

                    <td lass=" ">
                      <% if(item.dealType==0||item.dealType==2){ %>
                      <button type="button" class="btn btn-round btn-danger wuwu" datype="<%= item['_id'] %>"
                        typess="1">存在bug
                      </button>
                      <button type="button" class="btn btn-round btn-success wuwu" datype="<%= item['_id'] %>"
                        typess="3">审核通过 </button>
                      <%}else if(item.dealType==1){ %>
                      <button type="button" class="btn btn-primary">等待修改</button>
                      <% } else{%>
                      <button type="button" class="btn btn-success">审核通过</button>
                      <% }%>
                    </td>

                  </tr>
                </tbody>
                <% }) %>
                <% } %>

              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="hahaah">
      <div class="yyyy">
        <div class="row">
          <div class="x_panel">
            <div class="x_title">
              <h2>项目bug <small>Please fix the specified bug</small></h2>
              <ul class="nav navbar-right panel_toolbox">

                <li><a class="close-linkyaya"><i class="fa fa-close"></i></a>
                </li>
              </ul>
              <div class="clearfix"></div>
            </div>
            <div class="x_content">
              <br>
              <form id="myform" data-parsley-validate="" class="form-horizontal form-label-left" novalidate="">

                <div class="item form-group">
                  <label class="col-form-label col-md-3 col-sm-3 label-align" for="first_name">测试人员</label>
                  <div class="col-md-6 col-sm-6 ">
                    <input type="text" id="first_name" required="required" class="form-control "
                      value="<%=dd.username%>" name="first_name" disabled>
                  </div>
                </div>
                <div class="item form-group">
                  <label class="col-form-label col-md-3 col-sm-3 label-align" for="bugName">bug 名称</label>
                  <div class="col-md-6 col-sm-6 ">
                    <input type="text" id="bugName" name="bugName" required="required" class="form-control"
                      placeholder="请输入bug概要"><span class="aaaa bugName"></span>
                  </div>
                </div>
                <div class="item form-group">
                  <label for="bugContent" class="col-form-label col-md-n3 col-sm-3 label-align">bug 内容</label>
                  <div class="col-md-6 col-sm-6 ">
                    <input id="bugContent" class="form-control" type="text" name="bugContent"
                      placeholder="请输入bug详细内容"><span class="aaaa bugContent"></span>
                  </div>
                </div>
                <div class="item form-group">
                  <label class="col-form-label col-md-3 col-sm-3 label-align" for="proName">修改人</label>
                  <div class="col-md-6 col-sm-6 ">
                    <select id="proName" class="date-picker form-control gtgtg" required="required" type="text"
                      name="proName">
                     
                    </select><span class="aaaa proName"></span>
                  </div>
                </div>

                <div class="item form-group">
                  <label for="endTime" class="col-form-label col-md-3 col-sm-3 label-align">最晚提交时间</label>
                  <div class="col-md-6 col-sm-6 ">
                    <input id="endTime" class="form-control" type="text" name="endTime" placeholder="请输入最晚提交时间"
                      data-provide="datepicker"><span class="aaaa endTime"></span>
                  </div>
                </div>
                <div class="ln_solid"></div>
                <div class="item form-group">
                  <div class="col-md-6 col-sm-6 offset-md-3">
                    <button class="btn btn-primary" type="reset">Reset</button>
                    <button type="button" class="btn btn-success">Submit</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>



  </div>
  <script src="/javascripts/jquery-1.11.3.js"></script>
  <script src="/gentelella/vendors/jquery/dist/jquery.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/bootstrap/dist/js/bootstrap.bundle.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/fastclick/lib/fastclick.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/nprogress/nprogress.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/Chart.js/dist/Chart.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/gauge.js/dist/gauge.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/bootstrap-progressbar/bootstrap-progressbar.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/iCheck/icheck.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/skycons/skycons.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/Flot/jquery.flot.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/Flot/jquery.flot.pie.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/Flot/jquery.flot.time.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/Flot/jquery.flot.stack.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/Flot/jquery.flot.resize.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/flot.orderbars/js/jquery.flot.orderBars.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/flot-spline/js/jquery.flot.spline.min.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/flot.curvedlines/curvedLines.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/DateJS/build/date.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/jqvmap/dist/jquery.vmap.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/jqvmap/dist/maps/jquery.vmap.world.js" type="text/javascript"></script>
  <script src="/gentelella/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js" type="text/javascript"></script>
  <script src="/gentelella/build/js/custom.min.js" type="text/javascript"></script>
  <script src="/javascripts/bootstrap-datepicker.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.js"></script>
  <script>




   $.ajax({
      type:"get",
      url: "/memberTes/baba",
      dataType:"json"
    }).then(function(res){
      var html=" <option value=''>请指定开发者</option>";
      if(res.code==1){
        res.list.forEach(item => {
          html+=`<option value=${item.username}>${item.username}</option>`;
        })
      }else{
        html+=`<option value="">暂无开发人员</option>`;
      }
      $("#proName").html(html)
    })
 










    $("#endTime").datepicker({
      format: "yyyy-mm-dd",
      autoclose: true
    });

    var flag1 = false;
    var flag2 = false;
    var flag3 = false;
    var flag4 = false;



    $("#bugName").on("focuse blur input", function () {
      var bugName = $("#bugName").val();
      if (!bugName) {
        $(".bugName").html("Bug内容不能为空");
        flag1 = false
        return false;
      } else {
        $(".bugName").html("");
        flag1 = true;
        return true;
      }
    })

    $("#bugContent").on("focuse blur input", function () {
      var bugContent = $("#bugContent").val();
      if (!bugContent) {
        $(".bugContent").html("Bug详情不能为空");
        flag2 = false;
        return false;
      } else {
        $(".bugContent").html("");
        flag2 = true;
        return true;
      }
    })

    $("#proName").on("focuse blur input", function () {
      var proName = $("#proName").val();
      if (!proName) {
        $(".proName").html("请指定修改的开发者");
        flag3 = false;
        return false;
      } else {
        $(".proName").html("");
        flag3 = true;
        return true;
      }
    })

    $("#endTime").on("blur input change", function () {
      var endTime = $("#endTime").val();
      if (!endTime) {
        $(".endTime").html("请输入最晚修改时间");
        flag4 = false;
        return false;
      } else {
        $(".endTime").html("");
        flag4 = true;
        return true;
      }
    })

    $(document).on("click", "#gunqiu", function () {

      var id = $(this).attr("data_id");
      $(".hahaah").css({ display: "block" });


      $(".btn-success").click(function () {
        if (flag1 && flag2 && flag3 && flag4) {
          var datas = $("#myform").serializeArray();
          datas.push({ name: "id", value: id });
          console.log(datas)
          $.ajax({
            type: "post",
            url: "/memberTes/hahaha",
            data: datas,
            dataType: "json",
          }).then(function (res) {
            console.log(res);
            if (res.code == 1) {
              alert(res.msg);
              window.location.reload();
              $(".hahaah").css({ display: "none" })
            } else {
              alert(res.msg);
              $(".hahaah").css({ display: "none" })
            }
          })
        } else {
          alert("输入信息不完全,无法提交,请正确输入!!")
        }

      })


    })

    $(".close-linkyaya").click(function () {
      $(".hahaah").css({ display: "none" })
    })

    $(".wuwu").click(function () {

      var id = $(this).attr("datype");
      var type = $(this).attr("typess");
      console.log(id, type)
      $.ajax({
        type: "get",
        url: "/memberTes/haya",
        data: {
          id,
          type
        },
        dataType: "json",
      }).then(function (res) {
        if (res.code) {
          alert(res.msg);
          window.location.reload();
        } else {
          alert(res.msg);
        }
      })
    })



  </script>


</body>

</html>